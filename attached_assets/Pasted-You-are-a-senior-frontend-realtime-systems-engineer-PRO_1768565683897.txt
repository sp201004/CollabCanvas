You are a senior frontend + realtime systems engineer.

PROJECT CONTEXT:
This is a Real-Time Collaborative Drawing Canvas built with:
- Frontend: React + TypeScript + HTML Canvas
- Backend: Node.js + Socket.io
- No drawing libraries (raw Canvas API only)

GOAL:
Bring the project from "BORDERLINE PASS" to a **CLEAR FULL PASS** as per the assignment spec below.

VERY IMPORTANT RULES:
1. You must FIRST generate a clear, ordered TODO list (with priorities).
2. Then AUTOMATICALLY fix each item ONE BY ONE in order.
3. After finishing one item, immediately move to the next without asking me.
4. Do NOT add features that were explicitly removed:
   ❌ No LocalStorage
   ❌ No drawing persistence
   ❌ No export/import
5. Keep solutions simple, readable, and interview-explainable.
6. Prefer pointer events over mouse/touch split.
7. Fix code + UI + UX + docs wherever needed.
8. Do NOT stop until ALL TODOs are completed.

--------------------------------------------------
ASSIGNMENT MUST-HAVES (REFERENCE CHECKLIST)
--------------------------------------------------
✔ Real-time drawing (stream during draw, not after)
✔ Brush, eraser, colors, stroke width
✔ Global undo/redo (including SHAPES)
✔ Multi-user rooms
✔ Cursor indicators
✔ Mobile drawing support
✔ Clean toolbar UI (aligned, responsive)
✔ Canvas-based text tool (NO browser prompt)
✔ Pan & zoom correctness
✔ Proper socket cleanup on exit
✔ Correct TypeScript types
✔ Interview-safe explanations

--------------------------------------------------
CRITICAL BUGS TO FIX (MANDATORY)
--------------------------------------------------
1. ❌ Shape undo is broken
   - Shapes are added but NOT removed on undo
   - Fix onOperationUndo / onOperationRedo to support shapes

2. ❌ Mobile drawing does not work
   - Canvas has `touch-none`
   - Switch fully to Pointer Events
   - Ensure drawing works on phones & tablets

3. ❌ Cursor overlay breaks on zoom/pan
   - Cursor positions ignore canvas transform
   - Apply same transform matrix to cursor overlay

4. ❌ Text tool UX is wrong
   - Browser prompt is used
   - Replace with inline, canvas-positioned editable text box
   - Commit text to canvas on Enter / blur

5. ❌ Toolbar layout is broken
   - Icons misaligned
   - Stroke size slider broken (only label visible)
   - Fix spacing, alignment, grouping
   - Must work on desktop + mobile widths

6. ❌ Socket not fully disconnected on Exit
   - handleExitRoom emits room:leave
   - Also call socket.disconnect()

7. ❌ Typo in variable name
   - `odifyUserId` → `userId`
   - Fix everywhere consistently

--------------------------------------------------
OPTIONAL (BUT REQUIRED FOR FULL PASS)
--------------------------------------------------
✔ Shapes must be undoable
✔ Mobile touch must actually work
✔ Cursor sync must be accurate
✔ Toolbar must look intentional, not hacked
✔ Text tool must feel like Canva / Paint

--------------------------------------------------
WHAT YOU MUST DO NOW
--------------------------------------------------
STEP 1:
Create a **clear TODO list** grouped as:
- Critical bugs
- UX/UI fixes
- Architecture fixes
- Code quality fixes

STEP 2:
Start fixing TODOs **one by one**, in this order:
1️⃣ Shape undo/redo
2️⃣ Pointer events & mobile drawing
3️⃣ Cursor transform with zoom/pan
4️⃣ Inline canvas text tool
5️⃣ Toolbar alignment & responsive layout
6️⃣ Socket cleanup on exit
7️⃣ TypeScript typo cleanup

STEP 3:
For EACH fix:
- Explain briefly what was wrong
- Show the exact code change
- Ensure TypeScript types are correct

STEP 4:
After all fixes:
- Re-evaluate against assignment rubric
- Confirm this would pass a live interview

DO NOT ASK QUESTIONS.
DO NOT STOP HALFWAY.
JUST FIX EVERYTHING.
